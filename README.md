# Detective Conan: Zendesk Guide Logger

DetectiveConan is a lightweight logger designed to track user activities within Zendesk Guide before submitting a ticket request. This tool allows you to monitor key actions and store logs seamlessly in custom fields, making it easier to debug or investigate user behavior.

## Features

-   Track user activities like page visits, form interactions, and ad blocker detection.
-   Store logs in the browser’s session or local storage.
-   Automatically populate a custom Zendesk field with logs upon ticket submission.
-   Simple to set up and highly customizable through configuration options.

## How to Use

1. **Import the Script**  
   Include the DetectiveConan script in your page header or module.
2. **Initialize the Logger**  
   Create an instance of `DetectiveConan` with your desired configuration (default or custom).
3. **Log Submission on Form Submit**  
   Attach an event listener to your form’s submit button to log user activity into a custom Zendesk field.

### Basic Setup Example

```html
<!-- Include the script in your document head -->
<script type="module">
	// Import the DetectiveConan script
	import DetectiveConan from "https://cdn.lowquality.moe/detectiveConan.js";

	// Initialize the logger
	const detectiveConan = new DetectiveConan({});

	// Check if the custom logs field exists
	if (document.querySelector(".request_custom_fields_29378455335185")) {
		// (Optional) Hide the logs field from user view
		document.querySelector(".request_custom_fields_29378455335185").style.display = "none";

		// Add the event listener to submit logs when the form is submitted
		document.querySelector('input[type="submit"]').addEventListener("click", () => {
			document.getElementById("request_custom_fields_29378455335185").value = detectiveConan.getLogs();
		});
	}
</script>
```

## Configuration Options

DetectiveConan comes with a default configuration, which can be customized as needed.

### Default Configuration

```js
new DetectiveConan({
	// Default params
	enableUrl: true,
	enableOrigin: true,
	enableFormId: true,
	enableTicketFormRequestId: true,
	enableAdBlockerDetection: true,
	storageType: "sessionStorage",
	keyName: "userActivityLogs",
});
```

### Custom Configuration

When initializing the logger, you can override any of the default settings by providing only the options you wish to change. Here's a breakdown of all configurable options:

| Name                        | Type    | Default              | Allowed values                        | Description                                                          |
| --------------------------- | ------- | -------------------- | ------------------------------------- | -------------------------------------------------------------------- |
| `enableUrl`                 | Boolean | `true`               | `true` / `false`                      | Logs the current page URL when the page loads.                       |
| `enableOrigin`              | Boolean | `true`               | `true` / `false`                      | Logs the page origin when the page loads.                            |
| `enableFormId`              | Boolean | `true`               | `true` / `false`                      | Logs the form ID if present in the URL.                              |
| `enableTicketFormRequestId` | Boolean | `true`               | `true` / `false`                      | Logs the request ID if a ticket form field is visible.               |
| `enableAdBlockerDetection`  | Boolean | `true`               | `true` / `false`                      | Detects if the user has an ad blocker enabled.                       |
| `storageType`               | String  | `'sessionStorage'`   | `'sessionStorage'` / `'localStorage'` | Specifies where the logs are stored.                                 |
| `keyName`                   | String  | `'userActivityLogs'` | Any String                            | Defines the key name used to store the logs in the selected storage. |

## Additional Notes

-   The logs field in Zendesk (`request_custom_fields_29378455335185`) can be hidden from users, but it will still store logs for admin use.
-   Ensure that your custom field in Zendesk is properly set up to capture the log data generated by DetectiveConan.
